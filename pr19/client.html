<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç API</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .server-status {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .status-item {
            background: rgba(255,255,255,0.9);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 150px;
            backdrop-filter: blur(10px);
        }
        
        .status-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .online { color: #27ae60; }
        .offline { color: #e74c3c; }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .card h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #34495e;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
            font-family: 'Courier New', monospace;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .response-area {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 10px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .endpoint-list {
            list-style: none;
        }
        
        .endpoint-list li {
            background: #f8f9fa;
            margin: 8px 0;
            padding: 12px;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }
        
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 12px;
            margin-right: 10px;
        }
        
        .get { background: #d4edda; color: #155724; }
        .post { background: #d1ecf1; color: #0c5460; }
        .put { background: #fff3cd; color: #856404; }
        .delete { background: #f8d7da; color: #721c24; }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .status-2xx { background: #27ae60; color: white; }
        .status-4xx { background: #e74c3c; color: white; }
        .status-5xx { background: #f39c12; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üß™ –¢–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç API</h1>
            <p class="subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è REST API</p>
        </header>

        <div class="server-status">
            <div class="status-item">
                <div class="status-value online" id="basicStatus">üü¢ Online</div>
                <div>–ë–∞–∑–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä</div>
            </div>
            <div class="status-item">
                <div class="status-value online" id="advancedStatus">üü¢ Online</div>
                <div>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Å–µ—Ä–≤–µ—Ä</div>
            </div>
            <div class="status-item">
                <div class="status-value" id="requestCount">0</div>
                <div>–í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('basic')">üë• –ë–∞–∑–æ–≤—ã–π API</div>
            <div class="tab" onclick="switchTab('advanced')">‚ö° –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π API</div>
        </div>

        <div class="dashboard">
            <!-- –ë–∞–∑–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä -->
            <div class="tab-content active" id="basic-tab">
                <div class="card">
                    <h2>üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                    
                    <div class="form-group">
                        <label>–î–µ–π—Å—Ç–≤–∏–µ:</label>
                        <select id="userAction" onchange="updateUserForm()">
                            <option value="getAll">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö</option>
                            <option value="getById">–ü–æ–ª—É—á–∏—Ç—å –ø–æ ID</option>
                            <option value="create">–°–æ–∑–¥–∞—Ç—å</option>
                            <option value="update">–û–±–Ω–æ–≤–∏—Ç—å</option>
                            <option value="delete">–£–¥–∞–ª–∏—Ç—å</option>
                        </select>
                    </div>

                    <div id="userForm">
                        <!-- –§–æ—Ä–º–∞ –æ–±–Ω–æ–≤–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>

                    <button class="btn" onclick="executeUserAction()">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
                </div>

                <div class="card">
                    <h2>üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h2>
                    
                    <div class="form-group">
                        <label>–î–µ–π—Å—Ç–≤–∏–µ:</label>
                        <select id="productAction" onchange="toggleProductId()">
                            <option value="getAll">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</option>
                            <option value="getById">–¢–æ–≤–∞—Ä –ø–æ ID</option>
                        </select>
                    </div>

                    <div class="form-group" id="productIdGroup" style="display: none;">
                        <label>ID —Ç–æ–≤–∞—Ä–∞:</label>
                        <input type="number" id="productId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID" min="1">
                    </div>

                    <button class="btn btn-success" onclick="executeProductAction()">–ü–æ–ª—É—á–∏—Ç—å</button>

                    <div class="form-group" style="margin-top: 20px;">
                        <label>üîç –ü–æ–∏—Å–∫:</label>
                        <input type="text" id="searchQuery" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å...">
                        <button class="btn" onclick="executeSearch()" style="margin-top: 10px;">–ò—Å–∫–∞—Ç—å</button>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Å–µ—Ä–≤–µ—Ä -->
            <div class="tab-content" id="advanced-tab">
                <div class="card">
                    <h2>‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏</h2>
                    
                    <div class="form-group">
                        <label>–î–µ–π—Å—Ç–≤–∏–µ:</label>
                        <select id="taskAction" onchange="updateTaskForm()">
                            <option value="getAll">–í—Å–µ –∑–∞–¥–∞—á–∏</option>
                            <option value="create">–°–æ–∑–¥–∞—Ç—å</option>
                            <option value="update">–û–±–Ω–æ–≤–∏—Ç—å</option>
                            <option value="delete">–£–¥–∞–ª–∏—Ç—å</option>
                        </select>
                    </div>

                    <div id="taskForm">
                        <!-- –§–æ—Ä–º–∞ –æ–±–Ω–æ–≤–∏—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>

                    <button class="btn" onclick="executeTaskAction()">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
                </div>

                <div class="card">
                    <h2>üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                    
                    <button class="btn" onclick="getServerStats()" style="margin-bottom: 10px;">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                    <button class="btn btn-success" onclick="getServerInfo()">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>

                    <div style="margin-top: 20px;">
                        <h3>üìã Endpoints</h3>
                        <ul class="endpoint-list">
                            <li><span class="method get">GET</span> /api/tasks</li>
                            <li><span class="method post">POST</span> /api/tasks</li>
                            <li><span class="method put">PUT</span> /api/tasks/:id</li>
                            <li><span class="method delete">DELETE</span> /api/tasks/:id</li>
                            <li><span class="method get">GET</span> /api/stats</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>üì° –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞</h2>
            <div class="response-area" id="response">
                {/* –û—Ç–≤–µ—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –∑–∞–ø—Ä–æ—Å–∞ */}
            </div>
        </div>
    </div>

    <script>
        let requestCount = 0;
        const BASIC_SERVER = 'http://localhost:3000';
        const ADVANCED_SERVER = 'http://localhost:3001';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateUserForm();
            updateTaskForm();
            checkServersStatus();
            setInterval(checkServersStatus, 30000);
        });

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        function updateUserForm() {
            const action = document.getElementById('userAction').value;
            const formDiv = document.getElementById('userForm');
            let html = '';

            switch(action) {
                case 'getById':
                    html = `<div class="form-group">
                        <label>ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                        <input type="number" id="userId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID" min="1">
                    </div>`;
                    break;
                case 'create':
                    html = `<div class="form-group">
                        <label>–ò–º—è:</label>
                        <input type="text" id="userName" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="userEmail" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
                    </div>`;
                    break;
                case 'update':
                    html = `<div class="form-group">
                        <label>ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                        <input type="number" id="updateUserId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID" min="1">
                    </div>
                    <div class="form-group">
                        <label>–ù–æ–≤–æ–µ –∏–º—è:</label>
                        <input type="text" id="updateUserName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è">
                    </div>
                    <div class="form-group">
                        <label>–ù–æ–≤—ã–π email:</label>
                        <input type="email" id="updateUserEmail" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π email">
                    </div>`;
                    break;
                case 'delete':
                    html = `<div class="form-group">
                        <label>ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                        <input type="number" id="deleteUserId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID" min="1">
                    </div>`;
                    break;
            }

            formDiv.innerHTML = html;
        }

        function updateTaskForm() {
            const action = document.getElementById('taskAction').value;
            const formDiv = document.getElementById('taskForm');
            let html = '';

            switch(action) {
                case 'create':
                    html = `<div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏:</label>
                        <input type="text" id="taskTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                    </div>
                    <div class="form-group">
                        <label><input type="checkbox" id="taskCompleted"> –í—ã–ø–æ–ª–Ω–µ–Ω–∞</label>
                    </div>`;
                    break;
                case 'update':
                    html = `<div class="form-group">
                        <label>ID –∑–∞–¥–∞—á–∏:</label>
                        <input type="number" id="updateTaskId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID" min="1">
                    </div>
                    <div class="form-group">
                        <label>–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:</label>
                        <input type="text" id="updateTaskTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                    </div>
                    <div class="form-group">
                        <label><input type="checkbox" id="updateTaskCompleted"> –í—ã–ø–æ–ª–Ω–µ–Ω–∞</label>
                    </div>`;
                    break;
                case 'delete':
                    html = `<div class="form-group">
                        <label>ID –∑–∞–¥–∞—á–∏:</label>
                        <input type="number" id="deleteTaskId" placeholder="–í–≤–µ–¥–∏—Ç–µ ID" min="1">
                    </div>`;
                    break;
            }

            formDiv.innerHTML = html;
        }

        function toggleProductId() {
            const action = document.getElementById('productAction').value;
            const group = document.getElementById('productIdGroup');
            group.style.display = action === 'getById' ? 'block' : 'none';
        }

        function executeUserAction() {
            const action = document.getElementById('userAction').value;
            let url = BASIC_SERVER + '/api/users';
            let method = 'GET';
            let body = null;

            switch(action) {
                case 'getAll':
                    break;
                case 'getById':
                    const userId = document.getElementById('userId').value;
                    if (!userId) return alert('–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                    url += '/' + userId;
                    break;
                case 'create':
                    const name = document.getElementById('userName').value;
                    const email = document.getElementById('userEmail').value;
                    if (!name || !email) return alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                    method = 'POST';
                    body = JSON.stringify({ name, email });
                    break;
                case 'update':
                    const updateId = document.getElementById('updateUserId').value;
                    if (!updateId) return alert('–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                    url += '/' + updateId;
                    method = 'PUT';
                    body = JSON.stringify({
                        name: document.getElementById('updateUserName').value,
                        email: document.getElementById('updateUserEmail').value
                    });
                    break;
                case 'delete':
                    const deleteId = document.getElementById('deleteUserId').value;
                    if (!deleteId) return alert('–í–≤–µ–¥–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                    url += '/' + deleteId;
                    method = 'DELETE';
                    break;
            }

            makeRequest(url, method, body);
        }

        function executeProductAction() {
            const action = document.getElementById('productAction').value;
            let url = BASIC_SERVER + '/api/products';

            if (action === 'getById') {
                const productId = document.getElementById('productId').value;
                if (!productId) return alert('–í–≤–µ–¥–∏—Ç–µ ID —Ç–æ–≤–∞—Ä–∞');
                url += '/' + productId;
            }

            makeRequest(url, 'GET');
        }

        function executeSearch() {
            const query = document.getElementById('searchQuery').value;
            if (!query) return alert('–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å');
            const url = `${BASIC_SERVER}/api/search?q=${encodeURIComponent(query)}`;
            makeRequest(url, 'GET');
        }

        function executeTaskAction() {
            const action = document.getElementById('taskAction').value;
            let url = ADVANCED_SERVER + '/api/tasks';
            let method = 'GET';
            let body = null;

            switch(action) {
                case 'getAll':
                    break;
                case 'create':
                    const title = document.getElementById('taskTitle').value;
                    if (!title) return alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏');
                    method = 'POST';
                    body = JSON.stringify({
                        title,
                        completed: document.getElementById('taskCompleted').checked
                    });
                    break;
                case 'update':
                    const updateId = document.getElementById('updateTaskId').value;
                    if (!updateId) return alert('–í–≤–µ–¥–∏—Ç–µ ID –∑–∞–¥–∞—á–∏');
                    url += '/' + updateId;
                    method = 'PUT';
                    body = JSON.stringify({
                        title: document.getElementById('updateTaskTitle').value,
                        completed: document.getElementById('updateTaskCompleted').checked
                    });
                    break;
                case 'delete':
                    const deleteId = document.getElementById('deleteTaskId').value;
                    if (!deleteId) return alert('–í–≤–µ–¥–∏—Ç–µ ID –∑–∞–¥–∞—á–∏');
                    url += '/' + deleteId;
                    method = 'DELETE';
                    break;
            }

            makeRequest(url, method, body);
        }

        function getServerStats() {
            makeRequest(ADVANCED_SERVER + '/api/stats', 'GET');
        }

        function getServerInfo() {
            makeRequest(BASIC_SERVER + '/api/info', 'GET');
        }

        function makeRequest(url, method, body = null) {
            requestCount++;
            document.getElementById('requestCount').textContent = requestCount;

            const options = {
                method: method,
                headers: { 'Content-Type': 'application/json' }
            };

            if (body) options.body = body;

            fetch(url, options)
                .then(async response => {
                    const data = await response.json();
                    displayResponse({
                        url: url,
                        method: method,
                        status: response.status,
                        data: data,
                        timestamp: new Date().toLocaleString('ru-RU')
                    }, response.status);
                })
                .catch(error => {
                    displayResponse({
                        error: error.message,
                        timestamp: new Date().toLocaleString('ru-RU')
                    }, 0);
                });
        }

        function displayResponse(data, status) {
            const responseDiv = document.getElementById('response');
            const statusClass = status >= 200 && status < 300 ? 'status-2xx' :
                              status >= 400 && status < 500 ? 'status-4xx' : 'status-5xx';
            const statusBadge = status ? `<span class="status-badge ${statusClass}">${status}</span>` : '';

            responseDiv.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>${data.method} ${data.url}</strong> ${statusBadge}
                </div>
                <div style="color: #95a5a6; margin-bottom: 15px;">
                    ${data.timestamp}
                </div>
                <pre style="white-space: pre-wrap;">${JSON.stringify(data.data || data.error, null, 2)}</pre>
            `;
        }

        function checkServersStatus() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
            fetch(BASIC_SERVER + '/api/info')
                .then(r => {
                    document.getElementById('basicStatus').textContent = r.ok ? 'üü¢ Online' : 'üî¥ Offline';
                    document.getElementById('basicStatus').className = r.ok ? 'status-value online' : 'status-value offline';
                })
                .catch(() => {
                    document.getElementById('basicStatus').textContent = 'üî¥ Offline';
                    document.getElementById('basicStatus').className = 'status-value offline';
                });

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
            fetch(ADVANCED_SERVER + '/api/stats')
                .then(r => {
                    document.getElementById('advancedStatus').textContent = r.ok ? 'üü¢ Online' : 'üî¥ Offline';
                    document.getElementById('advancedStatus').className = r.ok ? 'status-value online' : 'status-value offline';
                })
                .catch(() => {
                    document.getElementById('advancedStatus').textContent = 'üî¥ Offline';
                    document.getElementById('advancedStatus').className = 'status-value offline';
                });
        }
    </script>
</body>
</html>